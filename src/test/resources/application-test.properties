# ============================================================
# Perfil de test: usado en CI (GitHub Actions) y desarrollo local
# Activa con: -Dspring.profiles.active=test
# ============================================================

# --- JPA / Hibernate ---
# create-drop: crea tablas al iniciar, las elimina al cerrar — aislamiento total entre runs
spring.jpa.hibernate.ddl-auto=create-drop
# Desactivar SQL en consola para mantener logs de CI limpios
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false
spring.jpa.properties.hibernate.generate_statistics=false

# --- HikariCP (pool más pequeño para tests) ---
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.minimum-idle=2

# --- Redis / Cache ---
spring.cache.type=redis
spring.data.redis.timeout=3000ms
spring.data.redis.lettuce.pool.max-active=4
spring.data.redis.lettuce.pool.max-idle=4
spring.data.redis.lettuce.pool.min-idle=1

# --- Actuator (exponer solo lo mínimo en tests) ---
management.endpoints.web.exposure.include=health
management.endpoint.health.show-details=never

# --- Logging (reducir ruido en CI) ---
logging.level.root=WARN
logging.level.org.e_commerce.backend_template=INFO
logging.level.org.hibernate.SQL=WARN
logging.level.org.hibernate.orm.jdbc.bind=WARN
logging.level.com.zaxxer.hikari=WARN
logging.level.org.springframework.security=WARN
logging.level.io.github.resilience4j=WARN
# No escribir archivo de log en CI
logging.file.name=

# --- Desactivar DevTools en tests ---
spring.devtools.livereload.enabled=false
spring.devtools.restart.enabled=false
